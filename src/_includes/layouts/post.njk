---
layout: layouts/base.njk
---

<article class="aa-post">
  <div class="container">

{# Top bar: back link (left) + one-touch share (right) #}
{% set shareUrl  = ((site.url or '') + page.url) %}
{% set shareText = (title or page.fileSlug) + ' — Archie’s Adventures' %}

<div class="aa-post__topbar">
  <a class="aa-post__back" href="/adventures/">
    ← Back to Adventures
  </a>

  <button
    type="button"
    class="aa-sharebtn"
    data-share-url="{{ shareUrl }}"
    data-share-title="{{ title }}"
    aria-label="Share this adventure">
    <!-- tiny share icon -->
    <svg aria-hidden="true" width="18" height="18" viewBox="0 0 24 24">
      <path fill="currentColor"
        d="M18 8a3 3 0 1 0-2.83-4H15a3 3 0 0 0 .2 1.07l-7.6 4.22A3 3 0 0 0 6 9a3 3 0 0 0 1.6 2.64l7.6 4.22A3 3 0 0 0 15 17a3 3 0 1 0 .17 1h.01a3 3 0 0 0-.18-1.07l-7.6-4.22A3 3 0 0 0 9 9a3 3 0 0 0-.2-1.07l7.6-4.22A3 3 0 0 0 18 8Z"/>
    </svg>
    Share
  </button>
</div>

    {% if cover %}
      <img class="aa-post__cover" src="{{ cover }}" alt="">
    {% endif %}

    <div class="aa-post__meta">
      {% if tags and tags.length %}
        <span class="chip chip--green">{{ tags[0] }}</span>
      {% endif %}
      <span class="aa-post__meta-chip">📅 {{ page.date | date("MMM dd, yyyy") }}</span>
      <span class="aa-post__meta-chip">⏱️ {{ content | readTime }}</span>
    </div>

    <h1 class="aa-post__title">{{ title }}</h1>

    {% if excerpt %}
      <p class="aa-post__subtitle">{{ excerpt }}</p>
    {% endif %}


    <div class="aa-post__card content">
      {{ content | safe }}
    </div>



<!-- Subscribe -->
  <div id="subscribe" class="aa-sub__card" style="text-align:center">
    <h2>Join the Adventure Club 📬</h2>
    <p>Don’t miss the next trip! Get new posts in your inbox.</p>
         <!-- Netlify Forms -->
      <form name="newsletter" method="POST" data-netlify="true"
            netlify-honeypot="bot-field" action="/thanks" class="aa-sub__form">
        <input type="hidden" name="form-name" value="newsletter">
        <p class="sr-only"><label>Don’t fill this out: <input name="bot-field"></label></p>

        <div class="aa-sub__row">
          <input aria-label="Your email" type="email" name="email" placeholder="Your email" required>
          <button class="aa-sub__btn" type="submit">Subscribe</button>
        </div>
      </form>
  </div>

    <div class="aa-post__footer">
      <p>Thanks for joining my adventure! ✨</p>
      <a class="btn-2tone" href="/adventures/">Discover More</a>
    </div>

  </div>
</article>


<script>
  // One-touch share (Web Share API with graceful fallback)
  document.addEventListener('click', async (e) => {
    const btn = e.target.closest('.aa-sharebtn');
    if (!btn) return;

    const title = btn.getAttribute('data-share-title') || document.title;
    const url   = btn.getAttribute('data-share-url')   || location.href;

    if (navigator.share) {
      try { await navigator.share({ title, url }); }
      catch (_) { /* user cancelled */ }
    } else {
      // Fallback: copy the URL
      try {
        await navigator.clipboard.writeText(url);
        const old = btn.textContent;
        btn.textContent = 'Copied!';
        setTimeout(() => (btn.textContent = old), 1200);
      } catch (_) {
        // Final fallback: open mail client with link
        location.href = 'mailto:?subject=' + encodeURIComponent(title) +
                        '&body=' + encodeURIComponent(url);
      }
    }
  });
</script>
